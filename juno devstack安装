sudo passwd root
route add default gw 186.100.41.1

/etc/yum.repos.d/CentOS-Base.repo
http://mirrors.163.com/.help/CentOS-Base-163.repo
屏蔽[addons]部分
同时修改为gpgcheck=0

/etc/yum.repos.d/epel-bootstrap.repo
修改stack.ch里面的bootstrap部分
baseurl=http://centos.ustc.edu.cn/epel/7/$basearch
#mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch
failovermethod=priority
enabled=1
gpgcheck=1

yum makecache
1.配置代理
export http_proxy=http://186.100.4.109:808
export https_proxy=http://186.100.4.109:808
export no_proxy=127.0.0.1,186.100.4.109,186.100.4.110

2.配置国内源：g/str1/s//str2/g    g/mirrorlist.centos.org/s//mirrors.aliyun.com/g
/etc/apt/sources.list
deb http://mirrors.aliyun.com/ubuntu/ precise main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ precise-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ precise-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ precise-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ precise-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ precise main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ precise-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ precise-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ precise-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ precise-backports main restricted universe multiverse

3.安装git
apt-get update

$sudo apt-get update
$sudo apt-get upgrade
$sudo apt-get dist-upgrade
$sudo apt-get install git

apt-get install git
git config --global http.proxy http://186.100.4.109:808
git config --global https.proxy http://186.100.4.109:808


4.更改pip源，需要新建pip.conf文件指定目标源（这里以豆瓣的pip源为例），避免因为pip源连接失败引起的安装失败
$ mkdir ~/.pip
$ vi ~/.pip/pip.conf
--------pip.conf--------
[global]
index-url=http://pypi.douban.com/simple/

或者
http://mirrors.aliyun.com/pypi/simple/


5.下载代码
git clone http://git.openstack.org/openstack-dev/devstack

cd /home/devstack
git checkout -b juno origin/stable/juno


6.需要开启安装ceilometer
cp samples/local.conf ./
修改local.conf
localrc单网卡配置文件
http://www.cloudcraft.cn/devstack-localrc-for-one-nic-installation/

官方
[[local|localrc]]

# Enable the ceilometer metering services
enable_service ceilometer-acompute ceilometer-acentral ceilometer-anotification ceilometer-collector

# Enable the ceilometer alarming services
enable_service ceilometer-alarm-evaluator,ceilometer-alarm-notifier

# Enable the ceilometer api services
enable_service ceilometer-api

disable_service n-net
enable_service q-svc
enable_service q-agt
enable_service q-dhcp
enable_service q-l3
enable_service q-meta

CINDER_BRANCH=stable/juno
GLANCE_BRANCH=stable/juno
HORIZON_BRANCH=stable/juno
KEYSTONE_BRANCH=stable/juno
KEYSTONECLIENT_BRANCH=stable/juno
NOVA_BRANCH=stable/juno
NOVACLIENT_BRANCH=stable/juno
NEUTRON_BRANCH=stable/juno
SWIFT_BRANCH=stable/juno
CEILOMETER_BRANCH=stable/juno

CINDER_REPO=https://github.com/openstack/cinder
GLANCE_REPO=https://github.com/openstack/glance
HORIZON_REPO=https://github.com/openstack/horizon
KEYSTONE_REPO=https://github.com/openstack/keystone
KEYSTONECLIENT_REPO=https://github.com/openstack/keystoneclient
NOVA_REPO=https://github.com/openstack/nova
NOVACLIENT_REPO=https://github.com/openstack/novaclient
NEUTRON_REPO=https://github.com/openstack/neutron
SWIFT_REPO=https://github.com/openstack/swift
CEILOMETER_REPO=https://github.com/openstack/ceilometer

HORIZON_REPO=https://github.com/openstack/horizon
HORIZON_BRANCH=stable/juno

7.
以官方的为准
http://docs.openstack.org/developer/devstack/guides/single-machine.html

先创建stack用户来运行Devstack脚本
cd /home/devstack/tools/
./create-stack-user.sh

修改devstack目录权限,让stack用户可以运行
chown -R stack:stack /home/devstack

切换到stack用户下
su stack
cd /home/devstack
./stack.sh

yum install -y openvswitch报错,手工安装
https://n40lab.wordpress.com/2014/09/04/openvswitch-2-3-0-lts-and-centos-7/


Unable to look up git.openstack.org (port 9418)

vi stackrc
里面的git下载代码改成http,此处控制代码下载方式
GIT_BASE=${GIT_BASE:-http://git.openstack.org}

No local packages or download links found for cffi>=0.8
导出证书
>> /etc/pki/tls/certs/ca-bundle.crt

(以下方法错误，仅记录）
直接下载安装https://pypi.python.org/simple/cffi/
pip install cffi-0.8.tar.gz 

/usr/lib/python2.7/site-packages/pip修改pip的路径
grep "https://pypi.python.org/simple/" * -r

default='https://pypi.python.org/simple/',
